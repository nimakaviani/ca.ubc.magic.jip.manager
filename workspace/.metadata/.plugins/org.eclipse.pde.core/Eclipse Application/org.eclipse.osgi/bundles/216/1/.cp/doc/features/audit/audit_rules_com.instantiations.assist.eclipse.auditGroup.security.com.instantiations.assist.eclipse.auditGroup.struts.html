<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="CodePro AnalytiX">
<title>Audit - Rules - Struts</title>
<style type="text/css">
  body {font: 70% verdana,arial,helvetica; color: #000000}
  p {margin: 0.5em 2em 1em; line-height: 1.5em}
  h1 {margin: 0px 0px 5px; font: 175% verdana,arial,helvetica}
  h2 {margin: 0px 0px 5px; font: bold 175% verdana,arial,helvetica}
  h3 {margin: 0px 0px 5px; font: 125% verdana,arial,helvetica}
  h4 {margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica}
  table tr th {font-size: 75%}
  table tr td {font-size: 75%} 
</style>
</head>

<body>
<table>
  <tr>
    <td>
      <h1><b><font face="Verdana" color="#CC0000">Audit - Rules - Struts</font></b></h1>
<b>Description</b><br/>This group contains audit rules that look for code that violates the best practices specified for programs using the Struts framework.</p>
</td>
  </tr><tr>
    <td>
      <b>Rules:</b>
<ul>
      <li><a href="#com.instantiations.assist.eclipse.audit.actionFieldRevalidated">Action Field Revalidated</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.actionRevalidated">Action Revalidated</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldDefineValidateMethod">Class Should Define Validate Method</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldHaveFinalStaticFields">Class Should Have Final Static Fields</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldHavePrivateFields">Class Should Have Private Fields</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldValidateAllFields">Class Should Validate All Fields</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingResetMethod">Missing reset() Method</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingValidatorName">Missing Validator Name</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.noActionForValidation">No Action For Validation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.noSuchFieldForValidation">No Such Field For Validation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.sameValidatorName">Same Validator Name</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.unvalidatedField">Unvalidated Action Field</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.unvalidatedFormField">Unvalidated Action Form Field</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.validationNotEnabled">Validation Not Enabled</a></li>
      </ul>
    </td>
  </tr>
</table>
<hr size="2">
<h4>Details</h4>
<h4><a name="com.instantiations.assist.eclipse.audit.actionFieldRevalidated">Action Field Revalidated</a></h4><p>
<b>Summary</b><br/>Only one <code>&lt;field-validator&gt;</code> should be declared for one action field.<p><b>Description</b><br/>This audit rule violates <code>&lt;field-validator&gt;</code> declarations that repeat more than once for one action field.<p><b>Security Implications</b><br/>When action field validator is declared more than once for one action field this could lead to an unexpected behavior or failure to validate the user input properly that could possibly allow an attacker to perform some kind of remote attack on a system.<p><b>Example</b><br/>The following declaration in <code>MyAction-validation.xml</code> declares validator for the field <code>name</code> twice and would thus be marked as violation:it results in an found bind:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Name is required.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Please enter your name.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.actionRevalidated">Action Revalidated</a></h4><p>
<b>Summary</b><br/>Only one <code>ActionName-validation.xml</code> file should be declared for one action.<p><b>Description</b><br/>This audit rule violates <code>ActionName-validation.xml</code> declarations that are found more than once in the project.<p><b>Security Implications</b><br/>When an action validator is declared more than once for one action, this could lead to an unexpected behavior or failure to validate the user input properly which could possibly allow an attacker to perform some kind of remote attack on a system.<p><b>Example</b><br/>A validation file <code>MyAction-validation.xml</code> for MyAction that is present in more than one place in the project will be marked as a violation.<h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldDefineValidateMethod">Class Should Define Validate Method</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must define a <code>validate</code> method.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that do not implement a <code>validate</code> method. The validate method is the standard mechanism for a Struts framework to validate fields.<p><b>Security Implications</b><br/>Fields that are not validated are security problem number one for web applications. Failing to validate fields can lead to many security vulnerabilities such as SQL injections and Cross-site scripting.<p><b>Example</b><br/>The following class would be flagged as a violation because the class in this example doesn't define <code>validate</code> method:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldHaveFinalStaticFields">Class Should Have Final Static Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must not contains non-final static fields.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that define non-final static fields.<p><b>Security Implications</b><br/>Non-final static fields can be changed by different instances of the form at the same time (on different threads), or between the time of change and the time of use. This fact can provide an opportunity for malicious code to make unsafe changes even if the field is private.<p><b>Example</b><br/>The following field would be flagged as a violation because it is static but is not final:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static String testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldHavePrivateFields">Class Should Have Private Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must contain only private fields.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that define non-private fields that are accessed by getters and setters. The setter method should be used only by the framework; setting an action form field from other actions is bad practice and should be avoided.<p><b>Security Implications</b><br/>Non-private fields can be accessed in a way that avoids validation and creates an invalid state for the Form object. This can be used by malicious code to create unexpected and unintended behavior.<p><b>Example</b><br/>The following field would be flagged as a violation because it is not private:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldValidateAllFields">Class Should Validate All Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it should validate all of the fields it declares.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> in which the validate method does not validate all of the fields defined by the class.<p><b>Security Implications</b><br/>Unvalidated fields is the number one security issue for web-applications. Unvalidated fields can lead to many security vulnerabilities such as SQL Injections and Cross Site scripting.<p><b>Example</b><br/>The following class would be flagged as a violation because the field <code>count</code> is not validated by <code>validate</code> method.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private int count;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionErrors validate(ActionMapping map,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest req)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionErrors err ActionErroes();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (testStr == null) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err.add(ActionErrors.GLOBAL_MESSAGE,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ActionMessage("testStr is null"));<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return super(map, req);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.assist.eclipse.audit.missingResetMethod">Missing reset() Method</a></h4><p>
<b>Summary</b><br/>Struts <code>ActionForm</code> subclasses should implement the <code>reset()</code> method.<p><b>Description</b><br/>This audit rule finds <code>ActionForm</code> subclasses that do not implement the <code>reset()</code> method.<p><b>Security Implications</b><br/>If some fields are not reset, they can have old values which can be used by an attacker.<p><b>Example</b><br/>The following class declaration would be flagged as a violation because it does not declare a <code>reset()</code> method:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class SomeForm extends ActionForm { }</code><h4><a name="com.instantiations.assist.eclipse.audit.missingValidatorName">Missing Validator Name</a></h4><p>
<b>Summary</b><br/>All validators used in validation logic should be declared in <code>validators.xml</code> configuration file.<p><b>Description</b><br/>This audit rule finds and violates the usages of validators whose <code>type</code> is not declared in <code>validators.xml</code>. <p><b>Security Implications</b><br/>The absence of a declaration of a validator used is a sign of a faulty approach to secure validation all other the application. Validation logic should be kept up to date.<p><b>Example</b><br/>The following <code>customBarFieldValidation</code> validator usage whould be marked as violation if the corresponding validator is not declared in <code>validators.xml</code> configuration file:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="bar"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="customBarFieldValidation"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a value for bar.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.noActionForValidation">No Action For Validation</a></h4><p>
<b>Summary</b><br/>Abandoned validation file is a sign that validation of the actions is not properly handled.<p><b>Description</b><br/>A validation file without a corresponding action could be a result of an action renaming, when developer forgot to rename a validation file.<p><b>Security Implications</b><br/>It indicates problems in the validation of the actions, that should be treated.<p><b>Example</b><br/>When file <code>AddItem-validation.xml</code> is found with no corresponding action in <code>struts.xml</code>, the violation is created. The proper action declaration in this case would look like this:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;struts&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;package name="sample" namespace="/sample" extends="struts-default"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action name="AddItem" class="my.sample.AddItemAction"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&gt;/pages/AddItem.jsp&lt;/result&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/package&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/struts&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.noSuchFieldForValidation">No Such Field For Validation</a></h4><p>
<b>Summary</b><br/>Abandoned field validation is a sign that validation of the actions is not properly handled.<p><b>Description</b><br/>A field validation declared without a corresponding field in the action class could be a result of a field being renamed, when the developer forgot to replace the field name in a validation file.<p><b>Security Implications</b><br/>It indicates problems in the validation of the actions, that should be treated.<p><b>Example</b><br/>Let there be a Struts form class, <code>PostForm</code>, that declares two fields, <code>title</code> and <code>message</code>. The following entry in the file <code>PostForm-validation.xml</code> will lead to a violation because it validates a non-existent field: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="requiredstring"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a name&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.sameValidatorName">Same Validator Name</a></h4><p>
<b>Summary</b><br/>Duplicating validator names cause errors in validation process.<p><b>Description</b><br/>This audit rule violates declarations of a validators with the same <code>name</code> attribute.<p><b>Security Implications</b><br/>From two validators with the same name only one will be executed. Duplicating validator names is usually a sign that validation in the application is out of order and should be fixed. Failing in doing so will allow the attacker to inject some kind of invalid data into application.<p><b>Example</b><br/>The following <code>validators.xml</code> configuration contains two declared validators with the same name; these declarations would be violated:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!DOCTYPE validators PUBLIC "-//OpenSymphony Group//XWork Validator Config 1.0//EN" "http://www.opensymphony.com/xwork/xwork-validator-config-1.0.dtd"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;validator name="custom" class="org.some.validation.old.CustomValidator1"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;validator name="custom" class="org.some.validation.new.CustomValidator2"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.unvalidatedField">Unvalidated Action Field</a></h4><p>
<b>Summary</b><br/>All fields of a Struts2 action should be validated even if some of them are unused.<p><b>Description</b><br/>In situations when one Struts2 action class is used in several forms and each form uses a subset of the classes fields it is a common mistake to validate only those fields which are used in a given form. <p><b>Security Implications</b><br/>This may allow an attacker to inject unvalidated input into your application. Thus, all fields of a form should be validated even if some of them are unused.<p><b>Example</b><br/>Let there be a Struts2 action class, <code>QuizAction</code>, that declares three fields, <code>name</code>, <code>age</code> and <code>answer</code>. The following entry in the <code>QuizAction-validation.xml</code> will lead to a violation because it validates only two of them: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="requiredstring"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a name&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="age"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="int"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param name="min"&gt;13&lt;/param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param name="max"&gt;19&lt;/param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Only people ages 13 to 19 may take this quiz&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.unvalidatedFormField">Unvalidated Action Form Field</a></h4><p>
<b>Summary</b><br/>All fields of a Struts action form should be validated even if some of them are unused.<p><b>Description</b><br/>In situations when one Struts action form class is used in several forms and each form uses a subset of the classes fields it is a common mistake to validate only those fields which are used in a given form. <p><b>Security Implications</b><br/>This may allow an attacker to inject unvalidated input into your application. Thus, all fields of a form should be validated even if some of them are unused.<p><b>Example</b><br/>Let there be a Struts form class, <code>QuizAction</code>, that declares three fields, <code>name</code>, <code>age</code> and <code>answer</code>. The following entry in the <code>validation.xml</code> will lead to a violation because it validates only two of them: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="quizForm"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field property="name" depends="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;arg key="quizForm.name"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field property="age" depends="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;arg key="quizForm.age"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.validationNotEnabled">Validation Not Enabled</a></h4><p>
<b>Summary</b><br/>Validation plug-in is disabled by default and should be explicitly enabled in Struts configuration. <p><b>Description</b><br/>This rule violates <code>struts-config.xml</code> configuration file that does not explicitly specify Validation framework enabled.<p><b>Security Implications</b><br/>Unvalidated input can be used by an attacker to perform all kinds of remote attacks.<p><b>Example</b><br/>The following code declares the usage of Struts validation framework. If <code>struts-config.xml</code> configuration file does not contain this code, it will be violated:<p>&nbsp;&nbsp;&nbsp;&nbsp;&lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;set-property property="pathnames" value="/technology/WEB-INF/validator-rules.xml, /WEB-INF/validation.xml"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plug-in&gt;</code></body>
</html>
