<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="CodePro AnalytiX">
<title>Audit - Rules - Struts</title>
<style type="text/css">
  body {font: 70% verdana,arial,helvetica; color: #000000}
  p {margin: 0.5em 2em 1em; line-height: 1.5em}
  h1 {margin: 0px 0px 5px; font: 175% verdana,arial,helvetica}
  h2 {margin: 0px 0px 5px; font: bold 175% verdana,arial,helvetica}
  h3 {margin: 0px 0px 5px; font: 125% verdana,arial,helvetica}
  h4 {margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica}
  table tr th {font-size: 75%}
  table tr td {font-size: 75%} 
</style>
</head>

<body>
<table>
  <tr>
    <td>
      <h1><b><font face="Verdana" color="#CC0000">Audit - Rules - Struts</font></b></h1>
<b>Description</b><br/>This group contains audit rules that look for code that violates the best practices specified for programs using the Struts framework.</p>
</td>
  </tr><tr>
    <td>
      <b>Rules:</b>
<ul>
      <li><a href="#com.instantiations.assist.eclipse.audit.actionFieldRevalidated">Action Field Revalidated</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.actionRevalidated">Action Revalidated</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.avoidFieldsInActionClasses">Avoid Fields in Action Classes</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.businessLogicInActionForm">Business Logic in ActionForm</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldDefineValidateMethod">Class Should Define Validate Method</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldHaveFinalStaticFields">Class Should Have Final Static Fields</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldHavePrivateFields">Class Should Have Private Fields</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.struts.classShouldValidateAllFields">Class Should Validate All Fields</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.createGlobalForwards">Create Global Forward</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.declareAccessors">Declare Accessors for All ActionForm Fields</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.dontCreateUnusedErrors">Don't Create Unused Error</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.duplicateValidationForm">Duplicate Validation Form</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.formDoesNotExtendValidatorClass">Form Does Not Extend Validator Class</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.incompleteReset">Incomplete reset()</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.invalidFormBeanClass">Invalid Form Bean Class</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.invokeSuperValidate">Invoke super.validate() in validate()</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingClassInWebXML">Missing Class in web.xml</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingResetMethod">Missing reset() Method</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingValidatorName">Missing Validator Name</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.noActionForValidation">No Action For Validation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.noSuchFieldForValidation">No Such Field For Validation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.sameValidatorName">Same Validator Name</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.sessionMustBeSynchronized">Session Must Be Synchronized</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.sessionScopeFormNeedsReset">Session-scope Form Needs reset()</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.strutsValidatorNotInUse">Struts Validator Not in Use</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.undefinedMessageKey">Undefined Message Key</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.unusedValidationForm">Unused Validation Form</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.unvalidatedField">Unvalidated Action Field</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.unvalidatedActionForm">Unvalidated Action Form</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.unvalidatedFormField">Unvalidated Action Form Field</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useActionInterface">Use Action Interface</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useGlobalForwards">Use Existing Global Forwards</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useForwardActionWherePossible">Use ForwardAction Where Possible</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useHtmlMessages">Use html:messages Instead of html:errors</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useInterceptorToTrackDuplicateSubmits">Use Interceptor to Track Duplicate Submits</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useStrutsTestCaseForUnitTesting">Use StrutsTestCase for Unit Testing</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useSuccessActionWherePossible">Use SuccessAction Where Possible</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.useValidType">Use Valid Type for Form-property</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.validationNotEnabled">Validation Not Enabled</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.validatorConfigurationFileDoesNotExist">Validator Configuration File Does Not Exist</a></li>
      <li><a href="#com.instantiations.assist.eclipse.struts.validatorDisabled">Validator Disabled</a></li>
      </ul>
    </td>
  </tr>
</table>
<hr size="2">
<h4>Details</h4>
<h4><a name="com.instantiations.assist.eclipse.audit.actionFieldRevalidated">Action Field Revalidated</a></h4><p>
<b>Summary</b><br/>Only one <code>&lt;field-validator&gt;</code> should be declared for one action field.<p><b>Description</b><br/>This audit rule violates <code>&lt;field-validator&gt;</code> declarations that repeat more than once for one action field.<p><b>Security Implications</b><br/>When action field validator is declared more than once for one action field this could lead to an unexpected behavior or failure to validate the user input properly that could possibly allow an attacker to perform some kind of remote attack on a system.<p><b>Example</b><br/>The following declaration in <code>MyAction-validation.xml</code> declares validator for the field <code>name</code> twice and would thus be marked as violation:it results in an found bind:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Name is required.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Please enter your name.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.actionRevalidated">Action Revalidated</a></h4><p>
<b>Summary</b><br/>Only one <code>ActionName-validation.xml</code> file should be declared for one action.<p><b>Description</b><br/>This audit rule violates <code>ActionName-validation.xml</code> declarations that are found more than once in the project.<p><b>Security Implications</b><br/>When an action validator is declared more than once for one action, this could lead to an unexpected behavior or failure to validate the user input properly which could possibly allow an attacker to perform some kind of remote attack on a system.<p><b>Example</b><br/>A validation file <code>MyAction-validation.xml</code> for MyAction that is present in more than one place in the project will be marked as a violation.<h4><a name="com.instantiations.assist.eclipse.struts.avoidFieldsInActionClasses">Avoid Fields in Action Classes</a></h4><p>
<b>Summary</b><br/>Fields must not be used in action classes.<p><b>Description</b><br/>This audit rule looks for fields in action classes. It will allow fields that are marked as "final", but other fields, whether instance or static, are flagged.<p><b>Example</b><br/>In the class below, the field "count" would be flagged:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyAction extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private int count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.businessLogicInActionForm">Business Logic in ActionForm</a></h4><p>
<b>Summary</b><br/>ActionForms should not contain any business logic.<p><b>Description</b><br/>This audit rule looks for subclasses of ActionForm that contain business logic. ActionForms should only be used to keep form data passed between the view and the controller. An ActionForm has business logic if it contains any methods other than getters, setters and a few other specific methods (validate, reset, toSession, and fromSession). Business logic should be moved into the model.<p><b>Example</b><br/>In the following class, the method generatePassword would be flagged as business logic that needs to be moved.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class UserFormBean extends ActionForm {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String email = "Missing address";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String password = "Missing password";<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public String getEmail() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(email);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void setEmail(String email) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.email = email;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public String getPassword() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(password);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void setPassword(String password) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.password = password;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void generatePassword() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random r = new Random(System.currentTimeMillis());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int len = 6 + r.nextInt() % 12;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] pass = new byte[len];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int i = 0; i &lt; len; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldDefineValidateMethod">Class Should Define Validate Method</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must define a <code>validate</code> method.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that do not implement a <code>validate</code> method. The validate method is the standard mechanism for a Struts framework to validate fields.<p><b>Security Implications</b><br/>Fields that are not validated are security problem number one for web applications. Failing to validate fields can lead to many security vulnerabilities such as SQL injections and Cross-site scripting.<p><b>Example</b><br/>The following class would be flagged as a violation because the class in this example doesn't define <code>validate</code> method:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldHaveFinalStaticFields">Class Should Have Final Static Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must not contains non-final static fields.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that define non-final static fields.<p><b>Security Implications</b><br/>Non-final static fields can be changed by different instances of the form at the same time (on different threads), or between the time of change and the time of use. This fact can provide an opportunity for malicious code to make unsafe changes even if the field is private.<p><b>Example</b><br/>The following field would be flagged as a violation because it is static but is not final:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static String testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldHavePrivateFields">Class Should Have Private Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it must contain only private fields.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> that define non-private fields that are accessed by getters and setters. The setter method should be used only by the framework; setting an action form field from other actions is bad practice and should be avoided.<p><b>Security Implications</b><br/>Non-private fields can be accessed in a way that avoids validation and creates an invalid state for the Form object. This can be used by malicious code to create unexpected and unintended behavior.<p><b>Example</b><br/>The following field would be flagged as a violation because it is not private:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.eclipse.analysis.audit.struts.classShouldValidateAllFields">Class Should Validate All Fields</a></h4><p>
<b>Summary</b><br/>If a class extends <code>org.apache.struts.action.ActionForm</code>, it should validate all of the fields it declares.<p><b>Description</b><br/>This audit rule looks for subclasses of <code>ActionForm</code> in which the validate method does not validate all of the fields defined by the class.<p><b>Security Implications</b><br/>Unvalidated fields is the number one security issue for web-applications. Unvalidated fields can lead to many security vulnerabilities such as SQL Injections and Cross Site scripting.<p><b>Example</b><br/>The following class would be flagged as a violation because the field <code>count</code> is not validated by <code>validate</code> method.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;class MyClass extends ActionForm<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private testStr = "Value";<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private int count;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionErrors validate(ActionMapping map,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest req)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionErrors err ActionErroes();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (testStr == null) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err.add(ActionErrors.GLOBAL_MESSAGE,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ActionMessage("testStr is null"));<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return super(map, req);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code>&nbsp;&nbsp;&nbsp;&nbsp; <h4><a name="com.instantiations.assist.eclipse.struts.createGlobalForwards">Create Global Forward</a></h4><p>
<b>Summary</b><br/>Use global forwards to avoid redundant forwards.<p><b>Description</b><br/>This audit rule looks for ActionForwarder instances that refer to the same page. If there are several actions doing redirection to the same page, it is better to create and use a global redirect.<p><b>Example</b><br/>Replace code like the following:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class Action1 extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionForward forward = new ActionForward("/jsp/example.jsp");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return forward;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>and<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class Action2 extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionForward forward = new ActionForward("/jsp/example.jsp");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return forward;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>with code like the following:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class Action1 extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("globalForwardName");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>and<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class Action2 extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("globalForwardName");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>Of course, you must also define your global forward in the configuration file, something like the following:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;global-forwards&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;forward name="globalForwardName" path="/jsp/example.jsp" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/global-forwards&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.declareAccessors">Declare Accessors for All ActionForm Fields</a></h4><p>
<b>Summary</b><br/>Declare public accessors for all ActionForm fields.<p><b>Description</b><br/>This audit rule looks for fields declared in ActionForm classes for which either the getter or setter method is not implemented. If accessor methods are not implemented, using this tag on a JSP page such as<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;html:text property="fieldName"&gt;</code><p>may cause an error.<p><b>Example</b><br/>The following class would be flagged because it does not implement a setter method for the "username" field.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class LoginForm extends ActionForm {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String password = null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String username = null;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public String getUsername() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (this.username);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public String getPassword() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (this.password);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void setPassword(String password) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.password = password;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.dontCreateUnusedErrors">Don't Create Unused Error</a></h4><p>
<b>Summary</b><br/>Don't create ActionErrors in validate() methods of ActionForm until an error is discovered.<p><b>Description</b><br/>This audit rule finds all created ActionError and ActionMessage instances and checks to see whether they are added (with method add) to the returned ActionErrors instance.<p><b>Example</b><br/>In the following method, the error assigned to the local variable named "error" would be flagged because it not added to the "errors" collection:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionErrors validate(ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionError error = new ActionError(null);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionMessage message;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = new ActionMessage(null);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionErrors errors = new ActionErrors();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors.add(ActionErrors.GLOBAL_ERROR, new ActionError("error.error"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors.add(ActionErrors.GLOBAL_ERROR, message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return errors;<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.duplicateValidationForm">Duplicate Validation Form</a></h4><p>
<b>Summary</b><br/>Multiple validation forms with the same name indicate that the validation logic is not up-to-date.<p><b>Description</b><br/>If two validation forms have the same name, the Struts Validator arbitrarily chooses one of the forms to use for input validation and discards the other. This decision might not correspond to the programmer's expectations. Moreover, it indicates that the validation logic is not being maintained, and can indicate that other, more subtle, validation errors are present.<p><b>Example</b><br/>If your validaton.xml file contains<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-validation&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="ProjectForm"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="ProjectForm"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-validation&gt;</code><p>then the second entry of form name="ProjectForm" would be flagged.<h4><a name="com.instantiations.assist.eclipse.struts.formDoesNotExtendValidatorClass">Form Does Not Extend Validator Class</a></h4><p>
<b>Summary</b><br/>Struts forms that are defined to use validation should extend a validator class.<p><b>Description</b><br/>In order to use the Struts Validator, a form must extend one of the following classes:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.DynaValidatorActionForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.DynaValidatorForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.ValidatorActionForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.ValidatorForm</code><p>You must extend one of these classes because the Struts Validator ties in to your application by implementing the validate() method in these classes.Forms derived from the following classes cannot use the Struts Validator:<br><br><code>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.action.ActionForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.action.DynaActionForm</code><p><b>Example</b><br/>If the struts-config.xml file contained the following tag and the class example.NotValidatorForm does not extends one of the validator classes listed above, the bean notValidatorForm would be flagged:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="notValidatorForm" type="example.NotValidatorForm"/&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.incompleteReset">Incomplete reset()</a></h4><p>
<b>Summary</b><br/>Reset each member variable in the reset() method.<p><b>Description</b><br/>If the reset() method is implemented, this audit rule checks to make sure that each member variable is reset.<p><b>Example</b><br/>The reset method below would be flagged because the username field is not reset.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class LoginForm extends ActionForm {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String password = null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String username = null;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void reset(ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.password = null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.invalidFormBeanClass">Invalid Form Bean Class</a></h4><p>
<b>Summary</b><br/>Classes used as form beans must subclass ActionForm.<p><b>Description</b><br/>All classes declared to be a form bean using the form-bean tag should be real form classes (be subclasses of ActionForm).<p><b>Example</b><br/>If the class com.instantiations.struts.example.actionforms.LoginForm did not extended the class ActionFrom, the following line would be flagged:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name="loginForm"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="com.instantiations.struts.example.actionforms.LoginForm"/&gt;</code><p><b>Notes</b><p>You can also use one of the following Struts forms:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.ValidatorForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.mock.MockFormBean<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.action.DynaActionForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.DynaValidatorForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.DynaValidatorActionForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.BeanValidatorForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.LazyValidatorForm<br>&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.validator.ValidatorActionForm</code><h4><a name="com.instantiations.assist.eclipse.struts.invokeSuperValidate">Invoke super.validate() in validate()</a></h4><p>
<b>Summary</b><br/>Always call super.validate() in your validate methods in ActionForm and check is super.validate() return null or not.<p><b>Description</b><br/>The validate() method should be implementated to invoke super.validate(), assigning the result to a local variable so that it can be compared with null, similar to the following example:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionErrors validate(ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionErrors errors = super.validate(mapping, request);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (errors == null){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors = new ActionErrors();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Code to add additional errors.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return errors;<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p><b>Example</b><br/>The following method would be flagged because it does not invoke super.validate():<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyActionForm extends ActionForm {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionErrors errors = new ActionErrors();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors.add(ActionErrors.GLOBAL_ERROR, new ActionError("error.error"));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return errors;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.missingClassInWebXML">Missing Class in web.xml</a></h4><p>
<b>Summary</b><br/>A class referenced in a web.xml file is not defined.<p><b>Description</b><br/>This audit rule checks the values of those attributes in a web.xml file whose values are supposed to be the fully qualified name of a class to ensure that the classes are defined.<p><b>Example</b><br/>In the following entry<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;controller className="your class here" .../&gt;</code><p>The value of the "className" attribute would be flagged.<h4><a name="com.instantiations.assist.eclipse.audit.missingResetMethod">Missing reset() Method</a></h4><p>
<b>Summary</b><br/>Struts <code>ActionForm</code> subclasses should implement the <code>reset()</code> method.<p><b>Description</b><br/>This audit rule finds <code>ActionForm</code> subclasses that do not implement the <code>reset()</code> method.<p><b>Security Implications</b><br/>If some fields are not reset, they can have old values which can be used by an attacker.<p><b>Example</b><br/>The following class declaration would be flagged as a violation because it does not declare a <code>reset()</code> method:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class SomeForm extends ActionForm { }</code><h4><a name="com.instantiations.assist.eclipse.audit.missingValidatorName">Missing Validator Name</a></h4><p>
<b>Summary</b><br/>All validators used in validation logic should be declared in <code>validators.xml</code> configuration file.<p><b>Description</b><br/>This audit rule finds and violates the usages of validators whose <code>type</code> is not declared in <code>validators.xml</code>. <p><b>Security Implications</b><br/>The absence of a declaration of a validator used is a sign of a faulty approach to secure validation all other the application. Validation logic should be kept up to date.<p><b>Example</b><br/>The following <code>customBarFieldValidation</code> validator usage whould be marked as violation if the corresponding validator is not declared in <code>validators.xml</code> configuration file:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="bar"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="customBarFieldValidation"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a value for bar.&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.noActionForValidation">No Action For Validation</a></h4><p>
<b>Summary</b><br/>Abandoned validation file is a sign that validation of the actions is not properly handled.<p><b>Description</b><br/>A validation file without a corresponding action could be a result of an action renaming, when developer forgot to rename a validation file.<p><b>Security Implications</b><br/>It indicates problems in the validation of the actions, that should be treated.<p><b>Example</b><br/>When file <code>AddItem-validation.xml</code> is found with no corresponding action in <code>struts.xml</code>, the violation is created. The proper action declaration in this case would look like this:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;struts&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;package name="sample" namespace="/sample" extends="struts-default"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action name="AddItem" class="my.sample.AddItemAction"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&gt;/pages/AddItem.jsp&lt;/result&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/package&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/struts&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.noSuchFieldForValidation">No Such Field For Validation</a></h4><p>
<b>Summary</b><br/>Abandoned field validation is a sign that validation of the actions is not properly handled.<p><b>Description</b><br/>A field validation declared without a corresponding field in the action class could be a result of a field being renamed, when the developer forgot to replace the field name in a validation file.<p><b>Security Implications</b><br/>It indicates problems in the validation of the actions, that should be treated.<p><b>Example</b><br/>Let there be a Struts form class, <code>PostForm</code>, that declares two fields, <code>title</code> and <code>message</code>. The following entry in the file <code>PostForm-validation.xml</code> will lead to a violation because it validates a non-existent field: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="requiredstring"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a name&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.sameValidatorName">Same Validator Name</a></h4><p>
<b>Summary</b><br/>Duplicating validator names cause errors in validation process.<p><b>Description</b><br/>This audit rule violates declarations of a validators with the same <code>name</code> attribute.<p><b>Security Implications</b><br/>From two validators with the same name only one will be executed. Duplicating validator names is usually a sign that validation in the application is out of order and should be fixed. Failing in doing so will allow the attacker to inject some kind of invalid data into application.<p><b>Example</b><br/>The following <code>validators.xml</code> configuration contains two declared validators with the same name; these declarations would be violated:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!DOCTYPE validators PUBLIC "-//OpenSymphony Group//XWork Validator Config 1.0//EN" "http://www.opensymphony.com/xwork/xwork-validator-config-1.0.dtd"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;validator name="custom" class="org.some.validation.old.CustomValidator1"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;validator name="custom" class="org.some.validation.new.CustomValidator2"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.sessionMustBeSynchronized">Session Must Be Synchronized</a></h4><p>
<b>Summary</b><br/>References to the session must be synchronized.<p><b>Description</b><br/>This audit rule looks for references to the session object that are not synchronized on the session. Because the controller servlet creates only one instance of your Action class and uses this one instance to service all requests, you need to write thread-safe Action classes. In particular, all references to the session object should be synchronized.<p><b>Example</b><br/>The following method would be flagged because of the references to session:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(ActionMapping mapping, ActionForm inForm,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request, HttpServletResponse response) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpSession session = request.getSession();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (session != null &amp;&amp; session.getAttribute("user") != null) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.setAttribute("user", (String) request.getParameter("username"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("success");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("fail");<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>It should be replaced by something similar to the following:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(ActionMapping mapping, ActionForm inForm,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request, HttpServletResponse response) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpSession session = request.getSession();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;synchronized (session) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (session != null &amp;&amp; session.getAttribute("user") != null) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.setAttribute("user", (String) request.getParameter("username"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("success");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("fail");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.sessionScopeFormNeedsReset">Session-scope Form Needs reset()</a></h4><p>
<b>Summary</b><br/>The reset() method in an ActionForm should be implemented if the form has session scope (it's not used for request scope).<p><b>Description</b><br/>This audit rule looks for classes that implement a form bean used by a session-scoped action and checks ro ensure that those classes implement a reset method.<p><b>Example</b><br/>If the configuration file contains following entries:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;action path="/viewsignin"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="com.instantiations.struts.example.actions.LoginAction"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scope="session"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name="loginForm"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validate="false"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input="/index.jsp"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter="/signin.jsp"&gt;</code><p>and<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="loginForm"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="com.instantiations.struts.example.actionforms.LoginForm"/&gt;</code><p>then the class LoginForm would be flagged if it does not define a reset method.<h4><a name="com.instantiations.assist.eclipse.struts.strutsValidatorNotInUse">Struts Validator Not in Use</a></h4><p>
<b>Summary</b><br/>Use the Struts validator to prevent vulnerabilities that result from unchecked input.<p><b>Description</b><br/>Unchecked input is the leading cause of vulnerabilities in J2EE applications. To prevent such attacks, use the Struts validator to check all program input before it is processed by the application. To use the Struts validator you should configure it in struts-config.xml:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plug-in&gt;</code><p><b>Example</b><br/>The tag &lt;struts-config&gt; would be flagged if it does not contain a ValidatorPlugIn declaration:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;struts-config&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;struts-config&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.undefinedMessageKey">Undefined Message Key</a></h4><p>
<b>Summary</b><br/>Message keys must be defined in the resource file.<p><b>Description</b><br/>This audit rule looks for uses of message keys that are not defined in the resource file. All messages created in the Action and ActionForm classes should be declared in the special resource file, which can be found with the Struts configuration file.<p><b>Example</b><br/>In the following code, the name of the message key would be flagged if the key "messages.invaliduser" did not exist in the resource file.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(ActionMapping mapping, ActionForm inForm,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request, HttpServletResponse response) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionMessages messages = new ActionMessages();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages.add(ActionMessages.GLOBAL_MESSAGE,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ActionMessage("messages.invaliduser"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveErrors(request, messages);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("fail");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.unusedValidationForm">Unused Validation Form</a></h4><p>
<b>Summary</b><br/>An unused validation form indicates that validation logic is not up-to-date.<p><b>Description</b><br/>It is easy for developers to forget to update validation logic when they remove or rename action form mappings. One indication that validation logic is not being properly maintained is the presence of an unused validation form.<p><b>Example</b><br/>If the struts-config.xml file contains:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-beans&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="login" type="example.LoginForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="validateForm" type="example.ValidatedForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-beans&gt;</code><p>and the validation.xml file contains<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-validation&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="login"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="validatedForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-validation&gt;</code><p>the entry for "validatedForm" would be flagged in the validation.xml file because it is not defined in struts-config.xml (note the subtle name difference).<h4><a name="com.instantiations.assist.eclipse.audit.unvalidatedField">Unvalidated Action Field</a></h4><p>
<b>Summary</b><br/>All fields of a Struts2 action should be validated even if some of them are unused.<p><b>Description</b><br/>In situations when one Struts2 action class is used in several forms and each form uses a subset of the classes fields it is a common mistake to validate only those fields which are used in a given form. <p><b>Security Implications</b><br/>This may allow an attacker to inject unvalidated input into your application. Thus, all fields of a form should be validated even if some of them are unused.<p><b>Example</b><br/>Let there be a Struts2 action class, <code>QuizAction</code>, that declares three fields, <code>name</code>, <code>age</code> and <code>answer</code>. The following entry in the <code>QuizAction-validation.xml</code> will lead to a violation because it validates only two of them: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;validators&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="name"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="requiredstring"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;You must enter a name&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field name="age"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field-validator type="int"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param name="min"&gt;13&lt;/param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param name="max"&gt;19&lt;/param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;message&gt;Only people ages 13 to 19 may take this quiz&lt;/message&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field-validator&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/validators&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.unvalidatedActionForm">Unvalidated Action Form</a></h4><p>
<b>Summary</b><br/>Every action form must have a corresponding validation form.<p><b>Description</b><br/>If a Struts action form mapping specifies a form, it must have a validation form defined under the Struts validator. If an action form mapping does not have a validation form defined, it may be vulnerable to a number of attacks that rely on unchecked input.<p><b>Example</b><br/>If the validation.xml file contains<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-validation&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="login"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="unvalidatedForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/formset&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-validation&gt;</code><p>and struts-config.xml file contains:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-beans&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="login" type="example.LoginForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="validatedForm" type="example.ValidatedForm"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-beans&gt;</code><p>then the action form validatedForm would be flagged because it's not referenced in validation.xml.<h4><a name="com.instantiations.assist.eclipse.audit.unvalidatedFormField">Unvalidated Action Form Field</a></h4><p>
<b>Summary</b><br/>All fields of a Struts action form should be validated even if some of them are unused.<p><b>Description</b><br/>In situations when one Struts action form class is used in several forms and each form uses a subset of the classes fields it is a common mistake to validate only those fields which are used in a given form. <p><b>Security Implications</b><br/>This may allow an attacker to inject unvalidated input into your application. Thus, all fields of a form should be validated even if some of them are unused.<p><b>Example</b><br/>Let there be a Struts form class, <code>QuizAction</code>, that declares three fields, <code>name</code>, <code>age</code> and <code>answer</code>. The following entry in the <code>validation.xml</code> will lead to a violation because it validates only two of them: <p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form name="quizForm"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field property="name" depends="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;arg key="quizForm.name"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;field property="age" depends="required"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;arg key="quizForm.age"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/field&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.useActionInterface">Use Action Interface</a></h4><p>
<b>Summary</b><br/>Use the Action interface rather than the Action abstract class.<p><b>Description</b><br/>This audit rule looks for actions that subclass the abstract class org.apache.struts.action.Action. They should subclass the interface org.apache.struts2.Action instead.<p><b>Example</b><br/>Replace this code<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class NewAction extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public org.apache.struts.action.ActionForward execute(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.action.ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.apache.struts.action.ActionForm form,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javax.servlet.http.HttpServletRequest request,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javax.servlet.http.HttpServletResponse response)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws java.lang.Exception<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("forward_name");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><p>with<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class NewAction implements Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public String execute() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "forward_name";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useGlobalForwards">Use Existing Global Forwards</a></h4><p>
<b>Summary</b><br/>Use the global forwards defined in the configuration file.<p><b>Description</b><br/>This audit rule looks for ActionForwarder instances that refer to a page defined in configuration file. Such instances should return a global redirect to the referenced page in order to make it easier to modify the redirect.<p><b>Example</b><br/>If the struts-config.xml file includes<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;global-forwards&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;forward name="globalForwardName" path="/jsp/example.jsp" /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/global-forwards&gt;</code><p>then the following execute method would be flagged:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionForward forward = new ActionForward("/jsp/example.jsp");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return forward;<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useForwardActionWherePossible">Use ForwardAction Where Possible</a></h4><p>
<b>Summary</b><br/>Do not create action classes that can be replaced with ForwardAction.<p><b>Description</b><br/>This audit rule looks for actions that can be replaced with ForwardAction. Actions should be implemented using standard classes when possible in order to increase the flexability of the system.<p><b>Example</b><br/>The following class would be flagged because it could be replaced by an instance of ForwardAction.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyAction extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionForm form,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse response)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(mapping.findForward("some_forward_action_name"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useHtmlMessages">Use html:messages Instead of html:errors</a></h4><p>
<b>Summary</b><br/>Use html:messages instead of html:errors.<p><b>Description</b><br/>This audit rule looks for uses of the html:errors tag within JSP files. When error messages need to be displayed to the end user, the html:messages tag should be used instead because it gets the markup language out of the resource bundle.<p><b>Example</b><br/>The following JSP tag would be flagged:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;html:errors ... &gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.useInterceptorToTrackDuplicateSubmits">Use Interceptor to Track Duplicate Submits</a></h4><p>
<b>Summary</b><br/>Don't use any token code in an Action class at all. The interceptors are designed to do all the work.<p><b>Description</b><br/>This audit rule looks for calls to saveToken(), resetToken() and isTokenValid(). Advises to replace them with a corresponding interceptor.<p><b>Example</b><br/>The following method would be flagged because of the invocation of the saveToken method:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Create token.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveToken(request);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("success");<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code><p>Similarly, the following method would be flagged because of the invocations of the isValidToken and resetToken methods:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(...) throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Validate token for duplication submission.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!isTokenValid(request)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("duplicate");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Reset token after transaction success.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetToken(request);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("success");<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useStrutsTestCaseForUnitTesting">Use StrutsTestCase for Unit Testing</a></h4><p>
<b>Summary</b><br/>Use StrutsTestCase instead of TestCase for unit-testing Struts classes.<p><b>Description</b><br/>This audit rule looks for subcasses of TestCase that include methods to test Struts-related classes. They should subclass StrutsTestCase in order to make use of the additional functionality defined by it.<p><b>Example</b><br/>The following class would be flagged because it extends TestCase even though it is clearly testing a Struts class.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class LoginActionTest extends TestCase {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void testExecute() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoginAction loginAction = new LoginAction();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(...);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useSuccessActionWherePossible">Use SuccessAction Where Possible</a></h4><p>
<b>Summary</b><br/>Do not create action classes that can be replaced with SuccessAction.<p><b>Description</b><br/>This audit rule looks for actions that can be replaced with SuccessAction. Actions should be implemented using standard classes when possible in order to increase the flexability of the system.<p><b>Example</b><br/>The following class would be flagged because it could be replaced by an instance of SuccessAction.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyAction extends Action {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public ActionForward execute(ActionMapping mapping,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionForm form,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest request,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse response)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws Exception {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return mapping.findForward("success");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.struts.useValidType">Use Valid Type for Form-property</a></h4><p>
<b>Summary</b><br/>All form-property tags in the Struts configuration file should have a valid type property.<p><b>Description</b><br/>This audit rule looks for form-property tags in the Struts configuration file that have an invalid type property. The type property should have one of the following values:<br>* java.math.BigDecimal<br>* java.math.BigInteger<br>* boolean and java.lang.Boolean<br>* byte and java.lang.Byte<br>* char and java.lang.Character<br>* java.lang.Class<br>* double and java.lang.Double<br>* float and java.lang.Float<br>* int and java.lang.Integer<br>* long and java.lang.Long<br>* short and java.lang.Short<br>* java.lang.String<br>* java.sql.Date<br>* java.sql.Time<br>* java.sql.Timestamp<p>You may also specify Arrays of these types (e.g. String[]) as well as concrete implementations of the Map interface, such as java.util.HashMap, or a List implementation, such as java.util.ArrayList.<p><b>Example:</b><br/>The properties "page" and "data" would be flagged because they are using invalid types.<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-bean name="checkoutForm" type="org.apache.struts.validator.DynaValidatorForm"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-property name="address" type="java.lang.String"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-property name="age" type="java.lang.Integer"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-property name="page" type="java.lang.StringBuffer"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form-property name="data" type="java.lang.Object"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form-bean&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.validationNotEnabled">Validation Not Enabled</a></h4><p>
<b>Summary</b><br/>Validation plug-in is disabled by default and should be explicitly enabled in Struts configuration. <p><b>Description</b><br/>This rule violates <code>struts-config.xml</code> configuration file that does not explicitly specify Validation framework enabled.<p><b>Security Implications</b><br/>Unvalidated input can be used by an attacker to perform all kinds of remote attacks.<p><b>Example</b><br/>The following code declares the usage of Struts validation framework. If <code>struts-config.xml</code> configuration file does not contain this code, it will be violated:<p>&nbsp;&nbsp;&nbsp;&nbsp;&lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;set-property property="pathnames" value="/technology/WEB-INF/validator-rules.xml, /WEB-INF/validation.xml"/&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plug-in&gt;</code><h4><a name="com.instantiations.assist.eclipse.struts.validatorConfigurationFileDoesNotExist">Validator Configuration File Does Not Exist</a></h4><p>
<b>Summary</b><br/>XML files referenced as validator configuration files in the struts-config.xml file should exist.<p><b>Description</b><br/>The Struts configuration file may specify two validator configuration files. This audit rule checks to ensure that every declared validator configuration file exists.<p><b>Example</b><br/>Given the following content in the struts-config.xml file:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;set-property property="pathnames" value="/WEB-INF/validator-rules.xml, /WEB-INF/validation.xml"/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plug-in&gt;</code><p>The appropriate value would be flagged, if either validator-rules.xml or validation.xml does not exist.<h4><a name="com.instantiations.assist.eclipse.struts.validatorDisabled">Validator Disabled</a></h4><p>
<b>Summary</b><br/>You shouldn't disable the form's validate() method in the action form mapping.<p><b>Description</b><br/>An action form mapping should never disable validation. Disabling validation disables the Struts Validator as well as any custom validation logic performed by the form.<p><b>Example</b><br/>The following action form mapping would be flagged because it disables validation<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;action path="/download"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="com.test.action.DownloadAction"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name="downloadForm"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scope="request"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input=".download"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validate="false"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;</code></body>
</html>
