<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="CodePro AnalytiX">
<title>Audit - Rules - Tainted User Input</title>
<style type="text/css">
  body {font: 70% verdana,arial,helvetica; color: #000000}
  p {margin: 0.5em 2em 1em; line-height: 1.5em}
  h1 {margin: 0px 0px 5px; font: 175% verdana,arial,helvetica}
  h2 {margin: 0px 0px 5px; font: bold 175% verdana,arial,helvetica}
  h3 {margin: 0px 0px 5px; font: 125% verdana,arial,helvetica}
  h4 {margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica}
  table tr th {font-size: 75%}
  table tr td {font-size: 75%} 
</style>
</head>

<body>
<table>
  <tr>
    <td>
      <h1><b><font face="Verdana" color="#CC0000">Audit - Rules - Tainted User Input</font></b></h1>
<b>Description</b><br/>This group contains audit rules that look for user input that is entered into vulnerable parts of the application.</p>
<p>Each of these audit rules uses the same set of parameters for controlling its behavior:</p><blockquote><dl><dt>Tainted Data Sources </dt><dd>A list of potential sources of tainted data that is shared across all such rules.</dd><dt>Tainted Data Sinks</dt><dd>A list of potential sinks for tainted data. This list is different for each rule.</dd></dl><h3><img src="../../images/auditrules/audit_tainted_input_source.gif"></h3></blockquote><p>For a discussion of how the rules in this category work, the kinds of violations they produce, and some possible resolutions for those violations, see <a href="tainted_user_input_description.html">A Description of the Tainted User Input Rules</a>.</p>
</td>
  </tr><tr>
    <td>
      <b>Rules:</b>
<ul>
      <li><a href="#com.instantiations.assist.eclipse.audit.attributeInjection">Attribute Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.codeInjection">Code Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.commandInjection">Command Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.crossSiteScripting">Cross-Site Scripting</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.doSThreat">Denial of Service Threat</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.httpResponseSplitting">HTTP Response Splitting</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.logForging">Log Forging</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.manipulationWithXPath">Manipulation with XPath</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.pathManipulation">Path Manipulation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.processControl">Process Control</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.reflectionInjection">Reflection Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.requestParamsInSession">Request Parameters In Session</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.resourceInjection">Resource Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.resourceURLManipulation">Resource URL Manipulation</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.sqlInjection">SQL Injection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.taintedFilter">Tainted Filter</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.taintedInternetAddress">Tainted Internet Address</a></li>
      </ul>
    </td>
  </tr>
</table>
<hr size="2">
<h4>Details</h4>
<h4><a name="com.instantiations.assist.eclipse.audit.attributeInjection">Attribute Injection</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into the <code>BasicAttribute</code> of a LDAP context search request without sanitizing.<p><b>Description</b><br/>This audit rule violates all <code>BasicAttribute</code> instance creations where tainted data is used.<p><b>Security Implications</b><br/>Only trusted data should be passed to a search request as an attribute, otherwise an attacker could possibly create a request that will provide access to otherwise inaccessible and sensitive data.<p><b>Example</b><br/>The following code creates a <code>BasicAttribute</code> with the use of unsanitized data retrieved from <code>HttpServletRequest</code> parameter and does not clean this data:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;LdapContext ctx = getLdapContext();<br/>&nbsp;&nbsp;&nbsp;&nbsp;String userName = req.getParameter("user");<br/>&nbsp;&nbsp;&nbsp;&nbsp;BasicAttribute attr = new BasicAttribute("userName", userName);<br/>&nbsp;&nbsp;&nbsp;&nbsp;try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NamingEnumeration users = ctx.search("ou=People,dc=example,dc=com", attr, null);</code><p><img src="../../images/auditrules/audit_attribute_injection.gif" width="586" height="115"></p><h4><a name="com.instantiations.assist.eclipse.analysis.codeInjection">Code Injection</a></h4><p>
<b>Summary</b><br/>Scripts being executed might be receiving data from the user or other unsafe sources.<p><b>Description</b><br/>Code Injection occurs when the user is able to enter data directly into scripts to be executed.<p>The difference between Code Injection and Command Injection is that Code Injection attempts try to introduce scripts that are then included as part of the application runtime, while Command Injection attacks execute the user input source from outside of the application runtime.<p>To detect violations, this audit rule searches the code for script executions such as <code>javax.script.ScriptEngine.eval(..)</code> and traces where the script data could have come from. In cases where the source of the query is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to execute the scripts, are editable by the user.If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>Successful Code Injection attacks can potentially have malicious scripts executed with permissions not guarded against by the program.<p><b>Example</b><br/>The invocation of the method <code>eval(..)</code> would be flagged as a violation since it uses information passed from a SWT Text widget:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;Text text = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;String script = text.getText();<br>&nbsp;&nbsp;&nbsp;&nbsp;ScriptEngine scriptEngine = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;scriptEngine.eval(script);<br></code><p><img src="../../images/auditrules/audit_code_injection.gif"></p><h4><a name="com.instantiations.assist.eclipse.analysis.commandInjection">Command Injection</a></h4><p>
<b>Summary</b><br/>Commands being executed might be receiving data from the user or other unsafe sources.<p><b>Description</b><br/>Command Injection occurs when the user is able to enter data directly into a command to be executed by the system.<p>The difference between Code Injection and Command Injection is that Code Injection attempts try to introduce scripts that are then included as part of the application runtime, while Command Injection attacks execute the user input source from outside of the application runtime.<p>To detect violations, this audit rule searches the code for command executions such as <code>java.lang.Runtime.exec(..)</code> and traces where the query data could have come from. In cases where the source of the command is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to execute methods, are editable by the user.If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>Successful Command Injection attacks can potentially have malicious commands executed with permissions not guarded against by the program.<p><b>Example</b><br/>The invocation of the method <code>executeQuery(..)</code> would be flagged as a violation since it uses the first name information passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;Text text = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;String command = text.getText();<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;Runtime.getRuntime().exec(command);<br></code><p><img src="../../images/auditrules/audit_command_injection.gif"></p><h4><a name="com.instantiations.assist.eclipse.analysis.crossSiteScripting">Cross-Site Scripting</a></h4><p>
<b>Summary</b><br/>User input might be getting printed directly out to a web site.<p><b>Description</b><br/>Cross-Site Scripting occurs when the user is able to enter data directly onto a web site they are visiting.<p>To detect violations, this audit rule searches the code for printing statements such as <code>HTTPServletResponse.getWriter().print(..)</code> and traces where the output data could have come from. In cases where the source of the write statement is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to potentially print to a web site, are editable by the user. If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>If a malicious user has access to enter a piece of JavaScript, the next user to load the web page could potentially have their cookies or other resources compromised.<p><b>Example</b><br/>The invocation of the method <code>print(..)</code> would be flagged as a violation since it prints the first name information passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse httpServletResponse = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;String firstName = servletRequest.getParameter("firstName");<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;httpServletResponse.getWriter().print(firstName);</code><p><img src="../../images/auditrules/audit_cross_site_scripting.gif"></p><h4><a name="com.instantiations.assist.eclipse.audit.doSThreat">Denial of Service Threat</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into methods that could assist the Denial of Service state without sanitizing.<p><b>Description</b><br/>This rule violates usage of an unvalidated user input in calls to methods that could assist the Denial of Service state.<p><b>Security Implications</b><br/>Only trusted data should be used in such methods, otherwise an attacker can provide data that will lead to fast depletion of a thread pool or other Denial of Service states.<p><b>Example</b><br/>The following code uses user input directly in a call to <code>Thread.sleep()</code>. By providing large values, an attacker can suspend a thread execution for a significant amount of time, which will ease the depletion of a thread pool:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;String pause = req.getParameter("pause");<br/>&nbsp;&nbsp;&nbsp;&nbsp;int seconds = Integer.valueOf(pause).intValue();<br/>&nbsp;&nbsp;&nbsp;&nbsp;Thread.sleep(seconds * 1000);</code><p><img src="../../images/auditrules/audit_denial_of_service.gif"></p><h4><a name="com.instantiations.assist.eclipse.analysis.httpResponseSplitting">HTTP Response Splitting</a></h4><p>
<b>Summary</b><br/>User input might be getting input directly into a HTTP response.<p><b>Description</b><br/>HTTP Response Splitting occurs when the user is able to enter data directly into an HTTP response.<p>To detect violations, this audit rule searches the code for statements such as <code>HTTPServletResponse.sendRedirect(..)</code> and traces where the redirection data could have come from. In cases where the source of the redirect location is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the HTTP response methods, are editable by the user. Note, the Cookie constructor is included since HTTP responses can include Cookie information through the <code>HttpServletResponse.addCookie(..)</code> method. If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p>Finally, cleaning methods such as <code>HttpServletResponse.encodeRedirectURL(String)</code>, are taken into account and thus if user input is cleaned, it won't get flagged when passed to a HTTP response.<p><b>Security Implications</b><br/>By having direct access to enter data directly into an HTTP response, a malicious user could potentially split the response by including a carriage return or a line feed, which can lead to a number of vulnerabilities.<p><b>Example</b><br/>The invocation of the method <code>sendRedirect(..)</code> would be flagged as a violation since it puts the first name information passed from a servlet request directly into a HTTP response:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse httpServletResponse = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;String firstName = servletRequest.getParameter("firstName");<br>&nbsp;&nbsp;&nbsp;&nbsp;httpServletResponse.sendRedirect(firstName);</code><p><img src="../../images/auditrules/audit_http_response_splitting.gif"></p><h4><a name="com.instantiations.assist.eclipse.analysis.logForging">Log Forging</a></h4><p>
<b>Summary</b><br/>User input might be getting used to write directly to a log.<p><b>Description</b><br/>Log Forging occurs when user input is printed directly to a log or as part of a log.<p>To detect violations, this audit rule searches the code for logging statements such as <code>logger.log(..)</code> and traces where the logging string could have come from. In cases where the source of the path is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to create paths, are editable by the user. If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>When a malicious user can enter information directly into the log, the application logging utility can become compromised.<p><b>Example</b><br/>The invocation of <code>log(..)</code> would be flagged as a violation since it uses the user name information passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;Logger logger = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;Level level = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;String userName = servletRequest.getParameter("userName");<br>&nbsp;&nbsp;&nbsp;&nbsp;String logMessage = "User input the following user name: " + userName;<br>&nbsp;&nbsp;&nbsp;&nbsp;logger.log(level,logMessage);</code><p><img src="../../images/auditrules/audit_log_forging2.gif" width="554" height="456"></p><h4><a name="com.instantiations.assist.eclipse.audit.manipulationWithXPath">Manipulation with XPath</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into methods creating an XPath expression without sanitizing.<p><b>Description</b><br/>This rule violates usage of an unvalidated user input as a part of string used in creating an XPath expression.<p><b>Security Implications</b><br/>Only trusted data should be used in an xpath expression, otherwise an attacker can perform an xpath injection, potentially bypassing the security system of an application and accessing sensitive data.<p><b>Example</b><br/>The following code uses user input directly as an XPath expression:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;String query = req.getParameter("query");<br/>&nbsp;&nbsp;&nbsp;&nbsp;XPathFactory factory = XPathFactory.newInstance();<br/>&nbsp;&nbsp;&nbsp;&nbsp;XPath xpath = factory.newXPath();<br/>&nbsp;&nbsp;&nbsp;&nbsp;XPathExpression expr = xpath.compile(query);</code><p><img src="../../images/auditrules/audit_manipulation_with_xpath.gif" width="446" height="115"></p><h4><a name="com.instantiations.assist.eclipse.analysis.pathManipulation">Path Manipulation</a></h4><p>
<b>Summary</b><br/>User input might be getting used to create a path to a resource.<p><b>Description</b><br/>Path Manipulation occurs when user input is used directly as a path or part of a path to a resource.<p>To detect violations, this audit rule searches the code for path creation statements such as <code>File file = new File(..)</code> and traces where the path could have come from. In cases where the source of the path is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to create paths, are editable by the user. If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>When a malicious user can enter a path directly, system or application files that are assumed protected from users can become vulnerable.<p><b>Example</b><br/>The invocation of the constructor <code>File(..)</code> would be flagged as a violation since it uses the path name information passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;String fileName = servletRequest.getParameter("fileName");<br>&nbsp;&nbsp;&nbsp;&nbsp;File file = new File("..." + fileName);</code><p><img src="../../images/auditrules/audit_path_manipulation.gif"></p><h4><a name="com.instantiations.assist.eclipse.analysis.processControl">Process Control</a></h4><p>
<b>Summary</b><br/>Process controlling code might be receiving data from the user or other unsafe sources.<p><b>Description</b><br/>Process Control occurs when the user is able to enter data directly into code that effects the process of the runtime. This can occur when the user has access to specify system commands or when then user has access to specify which libraries are loaded by the application.<p>To detect violations, this audit rule searches the code for process controlling code methods such as <code>java.lang.System.load(..)</code> and traces where the data could have come from. In cases where the source of the query is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to query the database, are editable by the user.If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>Successful Process Control attacks can potentially allow the user to specify source code to be executed.<p><b>Example</b><br/>The invocation of the method <code>System.loadLibrary(..)</code> would be flagged as a violation since it uses the library name information passed from a SWT widget:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;Text text = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;String library = text.getText();<br>&nbsp;&nbsp;&nbsp;&nbsp;System.loadLibrary(library);<br></code><p><img src="../../images/auditrules/audit_process_control.gif" width="463" height="140"></p><h4><a name="com.instantiations.assist.eclipse.audit.reflectionInjection">Reflection Injection</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into methods accessing classes, methods or fields via reflection without sanitizing.<p><b>Description</b><br/>This rule violates usage of an unvalidated user input as a part of class or method names referred to by reflection calls.<p><b>Security Implications</b><br/>Only trusted data should be used in reflection class, otherwise an attacker can instantiate a class or invoke a method of their choice, potentially bypassing the security system of an application. This can lead to faulty or unexpected behaviour.<p><b>Example</b><br/>The following code selects a class to instantiate with the use of unsanitized data retrieved from <code>HttpServletRequest</code> parameter and does not clean this data before instantiating the class:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;LdapContext ctx = getDirContext();<br/>&nbsp;&nbsp;&nbsp;&nbsp;String userName = req.getParameter("user");<br/>&nbsp;&nbsp;&nbsp;&nbsp;String filter = "(user=" + userName + ")";<br/>&nbsp;&nbsp;&nbsp;&nbsp;try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NamingEnumeration users = ctx.search("ou=People,dc=example,dc=com", filter, null);</code><p><img src="../../images/auditrules/audit_reflection_injection.gif" width="471" height="140"></p><h4><a name="com.instantiations.assist.eclipse.audit.requestParamsInSession">Request Parameters In Session</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into Session without sanitizing.<p><b>Description</b><br/>Sessions should only store trusted data, so that the developer accessing the data stored in a session would not have to decide whether to sanitize it.<p><b>Security Implications</b><br/>Data stored in a session is usually considered by a developer as a safe one to use. If this data is not checked, it could get into the security-sensitive parts of an application, opening it to all kinds of injection attacks.<p><b>Example</b><br/>The following code uses receives data via <code>HttpServletRequest#getParameter()</code> call and does not clean it before putting it into the session:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;login = request.getParameter("login");<br/>&nbsp;&nbsp;&nbsp;&nbsp;session.setAttribute(ATTR_LOGIN, login);</code><p><img src="../../images/auditrules/audit_request_parameters_in_session.gif" width="486" height="116"></p><h4><a name="com.instantiations.assist.eclipse.analysis.resourceInjection">Resource Injection</a></h4><p>
<b>Summary</b><br/>Users input should not be able to specify resource identifiers.<p><b>Description</b><br/>Resource Injection occurs when the user is able to provide resource identifiers such as a port number.<p>To detect violations, this audit rule searches the code for ServerSocket creation methods such as <code>java.net.ServerSocket.ServerSocket(int)</code> and traces where the query data could have come from. In cases where the source of the port number is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to identify resources, are editable by the user.If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p><b>Security Implications</b><br/>Successful Resource Injection attacks can potentially allow malicious users to gain access to resources not intended by the application.<p><b>Example</b><br/>The invocation of the constructor <code>ServletRequest(..)</code> would be flagged as a violation since it uses the port number passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest = ..;<br>&nbsp;&nbsp;&nbsp;&nbsp;String portNumberStr = servletRequest.getParameter("portNumber");<br>&nbsp;&nbsp;&nbsp;&nbsp;int portNumber = (new Integer(portNumberStr)).intValue();<br>&nbsp;&nbsp;&nbsp;&nbsp;ServerSocket serverSocket = new ServerSocket(portNumber);<br></code><p><img src="../../images/auditrules/audit_resource_injection.gif" width="485" height="113"></p><h4><a name="com.instantiations.assist.eclipse.audit.resourceURLManipulation">Resource URL Manipulation</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be used as a part of a URL accessed via <code>getResource()</code> or <code>getResourceAsStream()</code> calls.<p><b>Description</b><br/>Only trusted data should be used when creating a URL to access.<p><b>Security Implications</b><br/>Otherwise an attacker can specify an arbitrary path, potentially accessing a filesystem or other sensitive data.<p><b>Example</b><br/>The following code uses data from an HTTP request parameter to access a resource and does not validate this data:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;String resURL = req.getParameter("resURL");<br/>&nbsp;&nbsp;&nbsp;&nbsp;return ResourceRetriever.class.getResource(resURL);</code><p><img src="../../images/auditrules/audit_resource_url_manipulation.gif" width="443" height="115"></p><h4><a name="com.instantiations.assist.eclipse.analysis.sqlInjection">SQL Injection</a></h4><p>
<b>Summary</b><br/>SQL queries might be receiving data from the user or other unsafe sources.<p><b>Description</b><br/>SQL Injection occurs when the user is able to enter data directly into SQL queries.<p>To detect violations, this audit rule searches the code for SQL queries such as <code>java.sql.Statement.execute(..)</code> and traces where the query data could have come from. In cases where the source of the query is user input, such as data from a servlet request, <code>javax.servlet.ServletRequest.getParameter(java.lang.String)</code>, or from a SWT Text widget, <code>org.eclipse.swt.widgets.Text.getText()</code>, a violation is created.<p>These two sets of methods, the locations where tainted user data can come from and the methods used to query the database, are editable by the user.If methods are missing that are in a common package (such as <code>java.lang.*</code>), please let CodePro support know.<p>Also note, the SQL query methods for Hibernate and Persistence frameworks have been added.<p><b>Security Implications</b><br/>Successful SQL Injection attacks can potentially drop tables, update the database in a malicious manner and even gain administrator access.<p><b>Example</b><br/>The invocation of the method <code>executeQuery(..)</code> would be flagged as a violation since it uses the first name information passed from a servlet request:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;ServletRequest servletRequest;<br>&nbsp;&nbsp;&nbsp;&nbsp;Connection connection;<br>&nbsp;&nbsp;&nbsp;&nbsp;Statement statement;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;servletRequest = ...;<br>&nbsp;&nbsp;&nbsp;&nbsp;connection = DriverManager.getConnection("www.example.com", "myUserName", "myPassword");<br>&nbsp;&nbsp;&nbsp;&nbsp;statement = connection.createStatement();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;String firstName = req.getParameter("firstName");<br>&nbsp;&nbsp;&nbsp;&nbsp;String query = "SELECT * FROM user_data WHERE firstName = '" + firstName + "'";<br>&nbsp;&nbsp;&nbsp;&nbsp;statement.executeQuery(query);<br></code><p><img src="../../images/auditrules/audit_sql_injection.gif"></p><h4><a name="com.instantiations.assist.eclipse.audit.taintedFilter">Tainted Filter</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into LDAP context <code>search()</code> filter without sanitizing.<p><b>Description</b><br/>This audit rule violates the usage of unvalidated user input in LDAP search request filters.<p><b>Security Implications</b><br/>Only trusted data should be used in LDAP search filter, otherwise an attacker can create a malformed request similar to the classic SQL injection. This can lead to revealing otherwise protected data.<p><b>Example</b><br/>The following code receives data via <code>HttpServletRequest#getParameter()</code> call and does not clean it before putting it into the LDAP search filter:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;LdapContext ctx = getDirContext();<br/>&nbsp;&nbsp;&nbsp;&nbsp;String userName = req.getParameter("user");<br/>&nbsp;&nbsp;&nbsp;&nbsp;String filter = "(user=" + userName + ")";<br/>&nbsp;&nbsp;&nbsp;&nbsp;try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NamingEnumeration users = ctx.search("ou=People,dc=example,dc=com", filter, null);</code><p><img src="../../images/auditrules/audit_tainted_filter.gif" width="798" height="115"></p><h4><a name="com.instantiations.assist.eclipse.audit.taintedInternetAddress">Tainted Internet Address</a></h4><p>
<b>Summary</b><br/>Request parameters and other tainted data should not be passed into methods creating an InternetAddress without sanitizing.<p><b>Description</b><br/>This rule looks for places where tainted user input is used as a part of the string used in creating an InternetAddress.<p><b>Security Implications</b><br/>Only trusted data should be used in an InternetAddress, otherwise an attacker can perform a URL injection attack, potentially redirecting the system to access untrusted data.<p><b>Example</b><br/>The following code uses user input directly as an InternetAddress:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;String address = req.getParameter("address");<br/>&nbsp;&nbsp;&nbsp;&nbsp;InternetAddress addr = new InternetAddress(url);</code><p><img src="../../images/auditrules/audit_tainted_internet_address.gif"></p></body>
</html>
