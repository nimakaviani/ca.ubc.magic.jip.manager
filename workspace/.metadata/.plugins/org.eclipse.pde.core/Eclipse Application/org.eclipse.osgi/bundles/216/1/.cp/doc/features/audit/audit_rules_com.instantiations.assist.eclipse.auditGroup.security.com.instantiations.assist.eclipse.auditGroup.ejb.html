<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="CodePro AnalytiX">
<title>Audit - Rules - EJB</title>
<style type="text/css">
  body {font: 70% verdana,arial,helvetica; color: #000000}
  p {margin: 0.5em 2em 1em; line-height: 1.5em}
  h1 {margin: 0px 0px 5px; font: 175% verdana,arial,helvetica}
  h2 {margin: 0px 0px 5px; font: bold 175% verdana,arial,helvetica}
  h3 {margin: 0px 0px 5px; font: 125% verdana,arial,helvetica}
  h4 {margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica}
  table tr th {font-size: 75%}
  table tr td {font-size: 75%} 
</style>
</head>

<body>
<table>
  <tr>
    <td>
      <h1><b><font face="Verdana" color="#CC0000">Audit - Rules - EJB</font></b></h1>
<b>Description</b><br/>This group contains audit rules that check for problems defining EJB Session Beans, Entity Beans and Message Beans.</p>
</td>
  </tr><tr>
    <td>
      <b>Rules:</b>
<ul>
      <li><a href="#com.instantiations.assist.eclipse.audit.anyoneMethodPermission">'ANYONE' Method Permission</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidClassLoaders">Avoid Class Loaders in EJB</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidFileIO">Avoid File IO in EJB</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidGUI">Avoid GUI in EJB</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidLoadingNativeLibraries">Avoid Loading Native Libraries</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidManagingThreads">Avoid Managing Threads</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidPassingThisReferenceAsArgument">Avoid Passing this Reference as Argument</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidSockets">Avoid Sockets in EJB</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.avoidSynchronization">Avoid Synchronization in EJB</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.security.rule.ejb.beansMembersShouldBeSerializable">Bean Members Should Be Serializable</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.doNotAccessModifySecurityConfigurationObjects">Do not Access/Modify Security Configuration Objects</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.entityBeansRemoteInterface">Entity Bean's Remote Interface</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.missingErrorPage">Missing Error Page</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.realmDebugEnabled">Realm Debug Enabled</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.weblogicSessionIdLength">Weblogic Session ID Length</a></li>
      </ul>
    </td>
  </tr>
</table>
<hr size="2">
<h4>Details</h4>
<h4><a name="com.instantiations.assist.eclipse.audit.anyoneMethodPermission">'ANYONE' Method Permission</a></h4><p>
<b>Summary</b><br/>Method permission that grants access to the 'ANYONE' role should not be used.<p><b>Description</b><br/>Method permission that grants access to the 'ANYONE' role usually indicates a loose system access design that was not thought through thoroughly enough.<p><b>Security Implications</b><br/>Such a weak design can produce security holes that can be used by an attacker to access secured data.<p><b>Example</b><br/>The following declaration would be flagged as a violation because it sets the 'ANYONE' role to a method access permission:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;ejb-jar&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;assembly-descriptor&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;method-permission&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;role-name&gt;ANYONE&lt;/role-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;method&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ejb-name&gt;Account&lt;/ejb-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;method-name&gt;getBalance&lt;/method-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/method&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/method-permission&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/assembly-descriptor&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ejb-jar&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidClassLoaders">Avoid Class Loaders in EJB</a></h4><p>
<b>Summary</b><br/>The enterprise bean must not attempt to create a class loader, obtain the current class loader, or set the context class loader.<p><b>Description</b><br/>According to the EJB specification, the enterprise bean must not attempt to create a class loader, obtain the current class loader, or set the context class loader. These functions are reserved for the EJB container. <p><b>Security Implications</b><br/>Allowing the enterprise bean to use these functions could compromise security and decrease the Container's ability to properly manage the runtime environment.<p><b>Example</b><br/>The following code will be marked as a violation because it accesses a class loader in an EJB EntityBean:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClassLoader classLoader = MyBean.class.getClassLoader();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidFileIO">Avoid File IO in EJB</a></h4><p>
<b>Summary</b><br/>An enterprise bean must not use the java.io package to attempt to access files and directories in the file system.<p><b>Description</b><br/>According to the EJB specification, an enterprise bean must not use the java.io package to attempt to access files and directories in the file system. The file system APIs are not well-suited for business components to access data. Business components should use a resource manager API, such as JDBC, to store data.<p><b>Example</b><br/>The following code will be marked as a violation because it accesses a file loader in an EJB context:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInputStream fis = new FileInputStream("test.txt");<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidGUI">Avoid GUI in EJB</a></h4><p>
<b>Summary</b><br/>An enterprise bean must not use the AWT functionality to attempt to output information to a display, or to input information from a keyboard.<p><b>Description</b><br/>According to the EJB specification, an enterprise bean must not use the AWT functionality to attempt to output information to a display, or to input information from a keyboard. Most servers do not allow direct interaction between an application program and a keyboard/display attached to the server system.<p><b>Example</b><br/>The following code will be marked as a violation because it uses AWT GUI in an EJB context:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frame f = new Frame();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidLoadingNativeLibraries">Avoid Loading Native Libraries</a></h4><p>
<b>Summary</b><br/>Try to avoid using native code in EJB context if possible.<p><b>Description</b><br/>This audit rule looks for places where native libraries are loaded in EJB context.<p><b>Security Implications</b><br/>Native code is vulnurable to a lot of native-level attacks like buffer overflow. Its usage in security-sensitive contexts should be avoided if possible.<p><b>Example</b><br/>The following code will be marked as a violation because native libraries loaded in this case:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class ClassOne implements EntityBean {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void loadNative(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.loadLibrary("Library Name");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;....<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code><h4><a name="com.instantiations.assist.eclipse.audit.avoidManagingThreads">Avoid Managing Threads</a></h4><p>
<b>Summary</b><br/>Managing threads manually can cause errors and unpredictable behavior of a container.<p><b>Description</b><br/>Thread management in a J2EE environment is a responsibility of an application server. This rule looks for the direct usage and management of threads in J2EE <code>SessionBean</code>s and <code>EntityBean</code>s.<p><b>Security Implications</b><br/>Managing threads manually can cause errors and unpredictable behavior of a container.<p><b>Example</b><br/>The following code will be marked as a violation because it starts a new Thread in an EJB context:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new Thread().start();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidPassingThisReferenceAsArgument">Avoid Passing this Reference as Argument</a></h4><p>
<b>Summary</b><br/>You should not pass a reference to <code>this</code> as an argument or as a return value in EJB context.<p><b>Description</b><br/>This audit rule looks for a places in the code where a reference to <code>this</code> is returned or passed as an argument.<p><b>Security Implications</b><br/>Direct passing of a reference to an EJB bean is an incorrect usage of EJB which could lead to security issues. Use `getEJBObject()' available in SessionContext or EntityContext instead. See "Programming restrictions on EJB" (http://www.javaworld.com/javaworld/jw-08-2000/jw-0825-ejbrestrict.html) for details.<p><b>Example</b><br/>The following code will be marked as a violation because it attempts to return a this reference:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class ClassOne implements EntityBean {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public EntityBean getBean(){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;....<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code><h4><a name="com.instantiations.assist.eclipse.audit.avoidSockets">Avoid Sockets in EJB</a></h4><p>
<b>Summary</b><br/>An enterprise bean must not attempt to listen on a socket, accept connections on a socket, or use a socket for multicast.<p><b>Description</b><br/>According to the EJB specification, an enterprise bean must not attempt to listen on a socket, accept connections on a socket, or use a socket for multicast. The EJB architecture allows an enterprise bean instance to be a network socket client, but it does not allow it to be a network server. Allowing the instance to become a network server would conflict with the basic function of the enterprise bean - to serve the EJB clients.<p><b>Example</b><br/>The following code will be marked as a violation because it attempts to accept a socket connection in an EJB context:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerSocket ss = new ServerSocket(8080);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ss.accept();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.avoidSynchronization">Avoid Synchronization in EJB</a></h4><p>
<b>Summary</b><br/>An enterprise bean must not use thread synchronization primitives to synchronize execution of multiple instances.<p><b>Description</b><br/>According to the EJB specification, an enterprise bean must not use thread synchronization primitives to synchronize execution of multiple instances. Synchronization would not work if the EJB container distributed the enterprise bean's instances across multiple JVMs.<p><b>Example</b><br/>The following code will be marked as a violation because it uses <code>synchronize</code> mechanism in an EJB context:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyBean implements EntityBean {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void ejbActivate() throws EJBException, RemoteException {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;synchronize (this) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.security.rule.ejb.beansMembersShouldBeSerializable">Bean Members Should Be Serializable</a></h4><p>
<b>Summary</b><br>Members of beans should be marked as transient, static or should have accessors.<p><b>Description</b><br>This audit rule looks for bean members that are neither <code>static</code>, <code>transient</code> nor have acessors.<p><b>Security Implications</b><br>If a class is a bean, or is referenced by a bean directly or indirectly it needs to be serializable. Member variables need to be marked as transient, static, or have accessor methods in the class.<p><b>Example</b><br>The following declaraion of <code>badFoo</code> field will be marked as a violation because it is not static or transient and it does not have accessors:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;....<br/>&nbsp;&nbsp;&nbsp;&nbsp;private transient int someFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;private static int otherFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;private int moreFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;private int badFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;....<br/>&nbsp;&nbsp;&nbsp;&nbsp;private void setMoreFoo(int moreFoo) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.moreFoo = moreFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;private int getMoreFoo() {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this.moreFoo;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.doNotAccessModifySecurityConfigurationObjects">Do not Access/Modify Security Configuration Objects</a></h4><p>
<b>Summary</b><br/>Security policy should not be accessed or modified from EJB beans.<p><b>Description</b><br/>This audit rule looks for code that accesses or modifies security objects in an EJB context.<p><b>Security Implications</b><br/>The security of an application on the JVM execution level is implemented on a web application container level. Trying to manipulate it from inside the EJB code indicates a potentially dangerous approach to security of an application. An application should be reworked so that such access to security data is not required.<p><b>Example</b><br/>The following code would be flagged as a violation because it modifies a security object:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class ClassOne implements EntityBean {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void access (){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Policy.setPolicy(new MyPolicy());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;....<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code><h4><a name="com.instantiations.assist.eclipse.audit.entityBeansRemoteInterface">Entity Bean's Remote Interface</a></h4><p>
<b>Summary</b><br/>An Entity Bean exposed through a remote interface is a performance issue that should be avoided.<p><b>Description</b><br/>In most cases, the definition of a remote entity bean is the result of an error in the container configuration and should be avoided.<p><b>Security Implications</b><br/>An Entity bean exposed through a remote interface becomes accessible for an attacker that can use the performance issues that are caused by a remote entity bean to perform an attack on the server. <p><b>Example</b><br/>The following code would be flagged as a violation because it declares a remote interface for an entity bean:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;ejb-jar&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;enterprise-beans&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;entity&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ejb-name&gt;AccountEntry&lt;/ejb-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;home&gt;com.somecorp.beans.account.AccountEntryHome&lt;/home&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;remote&gt;com.somecorp.beans.account.AccountEntry&lt;/remote&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/entity&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/enterprise-beans&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ejb-jar&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.missingErrorPage">Missing Error Page</a></h4><p>
<b>Summary</b><br/>Error page should handle any exception in a web application.<p><b>Description</b><br/>This audit rule violates the web-app configuration file that does not declare a default error page, i.e. error page that catches all exceptions.<p><b>Security Implications</b><br/>Exceptions thrown from a servlet usually end with a stack trace printed to the end user. This stack trace may contain details of your system's architecture that provide valuable information for the attacker. To prevent this, add a default error that handles any Throwable.<p><b>Example</b><br/>The following web application declaration would be flagged as a violation because it does not handle any Throwable, including errors:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;web-app&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;error-page&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exception-type&gt;java.io.IOException&lt;/exception-type&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;location&gt;/error.jsp&lt;/location&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/error-page&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/web-app&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.realmDebugEnabled">Realm Debug Enabled</a></h4><p>
<b>Summary</b><br/>In Tomcat 4.x and earlier versions JAAS Realm debug level of 3+ logs users' credentials.<p><b>Description</b><br/>Tomcat realms log some information, its amount depending on the debug level regulated by the <code>debug</code> attribute. This audit rule violates declarations of <code>debug</code> attribute of values of 3 and higher for the JAAS <code>&lt;Realm&gt;</code> declarations in Tomcat server configurations.<p><b>Security Implications</b><br/>For most realms, debug level of 2 and higher logs the username, but JAASRealm does also log the password when debug level is 3 or higher. Having the password logged in plain text is a security risk that should be avoided, attacker could access the log file and retrieve passwords.<p><b>Example</b><br/>The following code declares a JAASRealm with a debug level of 3 and will be marked as a violation:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Realm className="org.apache.catalina.realm.JAASRealm" appName="MyFooRealm" userClassNames="org.foobar.realm.FooUser" roleClassNames="org.foobar.realm.FooRole" debug="99"&gt;</code><h4><a name="com.instantiations.assist.eclipse.audit.weblogicSessionIdLength">Weblogic Session ID Length</a></h4><p>
<b>Summary</b><br/>To protect a session from brute-force attacks, the session identifier length should be set to at least 24 bytes.<p><b>Description</b><br/>Estimations of the time and resources required to brute-force a session based on its identifier length show that to provide sufficient protection the identifier should be at least 24 bytes long. See details of an estimation at <a href="http://cwe.mitre.org/data/definitions/6.html">CWE-6 J2EE Misconfiguration: Insufficient Session-ID Length</a> common weakness description. Weblogic allows you to define the session id length in a configuration file. This rule finds Weblogic session id length declarations that set the session id length too short.<p><b>Security Implications</b><br/>Session ID of insufficient length can be bruteforced, thus granting an attacker a full access to the user's session.<p><b>Example</b><br/>The following code declares a session id length of 8 bytes and would thus be marked as violation:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;session-descriptor&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;session-param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDLength<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/param-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;8&lt;/param-value&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/session-param&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/session-descriptor&gt;</code></body>
</html>
