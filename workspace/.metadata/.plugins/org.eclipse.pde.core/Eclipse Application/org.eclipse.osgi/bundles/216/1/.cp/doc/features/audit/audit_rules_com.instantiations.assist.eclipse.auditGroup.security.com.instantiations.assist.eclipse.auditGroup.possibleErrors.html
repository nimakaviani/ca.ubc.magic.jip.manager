<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="CodePro AnalytiX">
<title>Audit - Rules - Possible Errors</title>
<style type="text/css">
  body {font: 70% verdana,arial,helvetica; color: #000000}
  p {margin: 0.5em 2em 1em; line-height: 1.5em}
  h1 {margin: 0px 0px 5px; font: 175% verdana,arial,helvetica}
  h2 {margin: 0px 0px 5px; font: bold 175% verdana,arial,helvetica}
  h3 {margin: 0px 0px 5px; font: 125% verdana,arial,helvetica}
  h4 {margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica}
  table tr th {font-size: 75%}
  table tr td {font-size: 75%} 
</style>
</head>

<body>
<table>
  <tr>
    <td>
      <h1><b><font face="Verdana" color="#CC0000">Audit - Rules - Possible Errors</font></b></h1>
<b>Description</b><br/>This group contains audit rules that look for places where the code might contain errors.</p>
</td>
  </tr><tr>
    <td>
      <b>Rules:</b>
<ul>
      <li><a href="#com.instantiations.assist.eclipse.arrayIsStoredWithoutCopying">Array Is Stored Without Copying</a></li>
      <li><a href="#com.instantiations.assist.eclipse.analysis.avoidComparingClassesByStrings">Avoid Comparing Classes By String Names</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.fieldMayHaveNullValue">Field Might Have Null Value</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.security.incompatibleTypesStoredInACollection">Incompatible types stored in a collection</a></li>
      <li><a href="#com.instantiations.assist.eclipse.callNextWithoutHasNext">Next method invoked without hasNext method</a></li>
      <li><a href="#com.instantiations.assist.eclipse.audit.usageOfBinaryComparison">Usage Of Binary Comparison</a></li>
      <li><a href="#com.instantiations.eclipse.analysis.audit.security.variableShouldNotHaveNullValue">Variable Has Null Value</a></li>
      </ul>
    </td>
  </tr>
</table>
<hr size="2">
<h4>Details</h4>
<h4><a name="com.instantiations.assist.eclipse.arrayIsStoredWithoutCopying">Array Is Stored Without Copying</a></h4><p>
<b>Summary</b><br>Storing of arrays without copying should not be used.<p><b>Description</b><br>This audit rule looks for places where arrays are stored without copying.<p><b>Security Implications</b><br>If constructors and methods receive and store arrays without copying, these arrays could be unpredictably changed from outside of the class.<p><b>Example</b><p>The following declaration of the <code>setArray</code> method will be marked as a violation because it does not copy its parameter:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;private String[] array;<br/>&nbsp;&nbsp;&nbsp;&nbsp;....<br/>&nbsp;&nbsp;&nbsp;&nbsp;public void setArray( String[] newArray){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.array = newArray;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/></code><h4><a name="com.instantiations.assist.eclipse.analysis.avoidComparingClassesByStrings">Avoid Comparing Classes By String Names</a></h4><p>
<b>Summary</b><br/>String comparisons should not occur with the output from Class.getName()<p><b>Description</b><br/>This audit rule looks for places where a class name is compared using the methods String.equals or String.equalsIgnoreCase, or the == or != operators.<p>Specifically, this audit rule flags the following patterns:<p><code>[class].getName().equals(*)<br>*.equals([class].getName())<br>[class].getName().equalsIgnoreCase(*)<br>*.equalsIgnoreCase([class].getName())<br>[class].getName() == *<br>* == [class].getName()<br>[class].getName() != *<br>* != [class].getName()</code><p>Where [class] is any instance of <code>java.lang.Class</code>.<p><b>Security Implications</b><br/>By not making comparisons in this way, code is prevented from malicious users creating a class with the same name in order to gain access to blocks of code not intended by the programmer.<p><b>Example</b><br/>The following method invocation of equals would be flagged a violation:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;if ("SomeClassName".equals(class.getName())) ...</code><h4><a name="com.instantiations.assist.eclipse.audit.fieldMayHaveNullValue">Field Might Have Null Value</a></h4><p>
<b>Summary</b><br/>You should check fields used in methods beacuse they might have <code>null</code> value.<p><b>Description</b><br/>This audit rule looks for references to fields whose value can be <code>null</code> where the value of the field is not checked before being dereferenced.<p><b>Security Implications</b><br/>Use checks on a null pointer because <code>NullPointerException</code> might be thrown.<p><b>Example</b><br/>The following usage of the field <code>date</code> will be marked as a violation beacuse it is not checked:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class TestClass {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Date date = null;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void badUsage() {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String myStr = date.toString();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.security.incompatibleTypesStoredInACollection">Incompatible types stored in a collection</a></h4><p>
<b>Summary</b><br/>You should avoid incompatible casts because a <code>ClassCastException</code> will be thrown.<p><b>Description</b><br/>This audit rule looks for places in the code that cast elements retrieved from a collection to a type that is not compatible with the type of elements being put into that very collection.<p><b>Security Implications</b><br/>Incompatible cast will cause a <code>ClassCastException</code> to be thrown. This could be used to create a potential denial-of-service state or reveal security-sensitive parts of an application's design through the stack trace.<p><b>Example</b><br/>The following invocation of the <code>get()</code> method will be marked as a violation because its return value is cast to a type incompatible with the one being put into collection:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public class MyClass {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private List testList;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void myMethod(MyClass obj) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testList.add(obj);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer test = (Integer)testList.get(0);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code><h4><a name="com.instantiations.assist.eclipse.callNextWithoutHasNext">Next method invoked without hasNext method</a></h4><p>
<b>Summary</b><br/>Do not invoke the <code>next</code> method if you do not invoke <code>hasNext</code> method before that because NoSuchElementException can be thrown.<p><b>Description</b><br/>This rule looks for places where the <code>next</code> method is invoked without or before the <code>hasNext</code> method.<p><b>Security Implications</b><br/>If the <code>next</code> method is invoked without first invoking the <code>hasNext</code> method, in loop for example, a NoSuchElementException may be thrown.<p><b>Example</b><br/>The following invocation of the <code>next</code> method will be flagged as a violation because the <code>hasNext</code> method is not invoked:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public void myMethod(Collection myList)<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.......<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterator iter = myList.iterator();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (int i = 0; i &lt; 10; i++) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter.next();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.assist.eclipse.audit.usageOfBinaryComparison">Usage Of Binary Comparison</a></h4><p>
<b>Summary</b><br/>You should use short-circuit operations instead of binary operations.<p><b>Description</b><br/>This rule looks for places where a binary operation is used that could be replaced by a short-circuit operator.<p><b>Security Implications</b><br/>Usage of binary operation instead of short-circuit can cause unexpected situation when RuntimeException or NullPointerException can be thrown.<p><b>Example</b><br/>The following code would be flagged as a violation because a binary and operator (&amp;) is used where a conditional-and operator (&amp;&amp;) could be used:<p><code>&nbsp;&nbsp;&nbsp;&nbsp;public void func(int[] a)<br/>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (a != null &amp; a.length() != 0) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doSomething();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;}</code><h4><a name="com.instantiations.eclipse.analysis.audit.security.variableShouldNotHaveNullValue">Variable Has Null Value</a></h4><p>
<b>Summary</b><br/>A variable that is guaranteed to have a null value and is used in an expression may indicate that the programmer forgot to initialize variable with its actual value.<p><b>Description</b><br/>This rule looks for a places where variables with <code>null</code> values are used in an expression.<p><b>Security Implications</b><br/>Such an error may indicate a flaw in the program's logic that may leave the software vulnerable if present in the security-sensitive part of an application.<p><b>Example</b><br/>The following usage of variable should be marked as violation because the variable is always <code>null</code>:<p>&nbsp;&nbsp;&nbsp;&nbsp;public boolean myMethod(String param)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String tmp = null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (tmp.equals(param)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}</code></body>
</html>
